<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-sclae=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <!--bootstrap integration-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <!--other css integration-->
    <link rel="stylesheet" href="rowStyle.css">

    <title>Dashboard</title>
</head>
<body>

<main class="container-fluid">

</main>

<!--scripting-->
<!--jquery integration-->

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>


<script>

    let sensorString = "sensor";
    let dateString = "date";
    let temperatureString = "temperature";
    let humidityString = "humidity";
    let luminosityString = "luminosity";
    let distanceString = "distance";

    function SortBySensor(a, b) {
        let aSensor = a[sensorString];
        let bSensor = b[sensorString];
        return ((aSensor < bSensor) ? -1 : ((aSensor > bSensor) ? 1 : 0));
    }

    function GenerateHTML(array) {
        if (Array.isArray(array)) {
            let rowId = 0;

            for (let i = 0; i < array.length; i++) {
                if (i % 4 == 0 || i == 0) {
                    $("main").append("<div class='row' id='" + rowId + "'>");
                    rowId++;
                }

                $("main").append("<div class='col-3'>" +
                    "   <div class='card' id='card_" + i + "'>" +
                    "       <div class='card-header'>" +
                    "           <span>Sensor " + array[i][sensorString] + "</span>" +
                    "       </div> " +
                    "       <div class='card-body'>" +
                    "           <div class='row'>" +
                    "               <div class='col-3'>" +
                    "                   <label for='tempField'>Temperature</label>" +
                    "               </div>" +
                    "               <div class='col-3'>" +
                    "                   <span id='tempField'>" + array[i][temperatureString] + "</span>" +
                    "               </div>" +
                    "               <div class='col-3'>" +
                    "                   <label for='distField'>Distance</label>" +
                    "               </div>" +
                    "               <div class='col-3'>" +
                    "                   <span id='distField'>" + array[i][distanceString] + "</span>" +
                    "               </div>" +
                    "           </div>" +
                    "           <div class='row'>" +
                    "               <div class='col-3'>" +
                    "                   <label for='humiField'>Humidity</label>" +
                    "               </div>" +
                    "               <div class='col-3'>" +
                    "                   <span id='humiField'>" + array[i][humidityString] + "</span>" +
                    "               </div>" +
                    "               <div class='col-3'>" +
                    "                   <label for='lumiField'>Luminosity</label>" +
                    "               </div>" +
                    "               <div class='col-3'>" +
                    "                   <span id='lumiField'>" + array[i][luminosityString] + "</span>" +
                    "               </div>" +
                    "           </div>" +
                    "       </div>" +
                    "       <div class='card-footer'>" +
                    "           <span>" + array[i][dateString] + "</span>" +
                    "       </div>" +
                    "   </div> " +
                    "</div>");

                if (i % 4 == 3 || i == array.length - 1) {
                    $("main").append("</div>");
                }
            }
        }
    }

    $(document).ready(function () {
        $.getJSON("testData.json", function (data) {

            //sort received data-array by sensor_id
            data.sort(SortBySensor);
            GenerateHTML(data);

            // loop through received data and generate html
            $.each(data, function (index, value) {
                //console.log(index + " " + value[sensorString]);
            });
        });
    });

    /*
$.ajax({
url: "https://htw-iiot-cloud.eu-gb.mybluemix.net/",
}).then(function (data) {
console.log("shit works yo");

$('').append(data.sensorId);
$('').append(data.temperature);
$('').append(data.humidity);
$('').append(data.lightIntensity);
$('').append(data.distance);
$('').append(data.dateTimeString);

});
*/

    /*
    var cards = document.getElementsByClassName('card');

    $(document).ready(function () {
        $(cards).click(function () {
            console.log('Card ' + this.id + ' has been clicked!');
        });
    });
    */
</script>

</body>
</html>